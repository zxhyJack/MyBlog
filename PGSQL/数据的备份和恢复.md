pgsql数据备份和恢复
================

生产环境中的数据是很重要的，定期备份是必须的，pgsql提供了备份和恢复的命令，非常使用

数据备份
------
pgsql提供了 `pg_dump` 命令，支持将现有的表结构和数据以 `sql` 命令的形式转储到文件中，当把这个文件回馈给服务器时，将重建与转储时状态一样的数据库。具体用法是：

    pg_dump _dbname_ > _outfile_
    
- `dbname` 是数据库名
 - `outfile` 是生成的sql文件

该命令提供多个命令，可以使用 `pg_dump --help` 命令查看详细的使用信息

- `-d` 指定数据库
- `-t` 指定数据表

例如：

    pg_dump -d _dbname_ -t _table_ > _outfile_

数据恢复
-------
直接上命令

    psql _dbname_ < _infile_

- `infile` 是要恢复的sql文件

数据恢复过程中可能会出错，这样恢复得到的数据就会不完整，所以要添加事务

可以通过向psql传递-1或者--single-transaction命令行 参数实现要么全部恢复成功， 要么全部回滚

**注意 `<` `>` 的方向，备份文件是指向sql文件，恢复文件是背离sql**
